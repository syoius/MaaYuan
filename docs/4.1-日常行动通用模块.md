# 日常行动通用模块

如无说明，则都没有定义`"next"`，建议配合`"interrupt"`字段使用。

> Tips: ✅ 代表已实装，⏳ 代表拟定更改，❓ 代表开发检讨中，➡️ 表示该模块有"next"字段指向

❓需要商定/更换命名规范吗

## 1. 常用导航类操作

基本都存放在 **`mainmap.json`** 中。

### ✅`"返回主界面左半屏"`

除以下场景外都能执行成功：

- 密探重置（真的有必要考虑吗？）
- 关卡扫荡界面（可以加，但好像没必要？可以再议）

### ✅`"返回主界面右半屏"`

同上

### ✅`"返回上级界面"`

点击屏幕左上角（默认的返回图标）一次，且不会点到小广头像

### ⏳ `"进入鸢报"` 等主要功能界面  

可以利用 `"interrupt"`字段 + `"返回主界面X半屏"` 对主要功能导航进行整合重写。

整合后，使用时直接利用`"interrupt"`字段调用`"进入XX"`即可。

如下例：

**（1） 整合后的"进入鸢报"界面导航**

**设计思路**：通过 OCR 确认当前是否已在鸢报界面。如不在，则尝试通过 OCR 识别并点击 `鸢报` 入口。如果还识别不到（即当前不在主界面左半屏），则触发导航 `"返回主页面左半屏"` → 识别到并点击进入 `鸢报` 界面。

```json
"进入鸢报": {
    "next": ["已在鸢报界面"],
    "interrupt": ["找到鸢报入口", "返回主界面左半屏"]
},
"已在鸢报界面":{
    "recognition": "OCR",
    "expected": "突发情报",
    "roi": [70,643,79,166]
}
"找到鸢报入口":{
    "recognition": "OCR",
    "expected": "鸢报",
    "roi": [206, 513, 141, 223],
    "action": "Click",
    "post_delay": 2000
}
```

**（2） 使用例**

**设计思路**：通过 OCR 识别并点击 `突发情况` 入口，如果识别不到（即当前不在 `鸢报` 界面内），则通过 `interrupt` 触发导航 `"进入鸢报"`，最终导航至 `鸢报` 界面 → 识别到并点击进入 `突发情况` 界面。

```json
"开始处理鸢报-突发情况": {
    "next": ["进入突发情况界面"],
    "interrupt": ["进入鸢报"]
},
"进入突发情况界面": {
    "recognition": "OCR",
    "expected": "突发情况",
    "action": "Click",
    "post_delay": 2000
    "next": ["点击前往调查（突发情况）"]
},
```

## 2. 屏幕控制类操作

### ❓`"向上/下/左/右滑动"`

适用于选人/找情报/找关卡等需要翻页的情景

### ❓ `"点击"`等其他常用键鼠 input

> ⚠️ 待验证：各类`跳过`键的位置是否一致
> 
> `突发情报-羁绊对话`和`鸢记`右上角`跳过`的重合区域`"roi": [589, 143, 70, 32]`

方便套娃调用或直接调用连续动作


## 3. 弹窗处理类操作

基本都存放在 **`popups.json`** 中，少部分待更改的测试版指令存放在 **`interruptpop.json`** 中。

### ✅ `"退出popup" ` （⏳ 或许更名为`"退出回复popup"`？）

通过点击`回复气力值`或`回复体力`弹窗右上角的退出图标来关闭弹窗

### ✅ `"退出分享popup" `

> ⚠️ 未测试是否适用于`剧情分享界面`（如`鸢记`）

通过点击`密探分享界面`弹窗右上角的退出图标来关闭弹窗

### ⏳`"退出关卡扫荡popup"`

> ⚠️ 好像不适用于历练扫荡，待测试

通过点击右上角的退出图标来关闭白鹄扫荡窗口

### ✅ `"右上角退出今日不再提醒popup" `

对于需要确认的`今日不再提醒界面`弹窗，通过点击右上角的退出图标来关闭弹窗（下次依旧会弹出）

### ⏳`"new今日不再提醒popup"` ➡️ `"new退出今日不再提醒"`

> ⚠️ 目前在 **`interruptpop.json`** 中，待统一命名并转移

点击勾选`今日不再提醒`后 ➡️ 点击`确认`键，弹窗自然关闭（下次不会再弹出）

### ⏳ `"new气力值回复"` ➡️ `[ "new鸟食耗尽check", "new确认回复气力值"]`

> ⚠️ 目前在 **`interruptpop.json`** 中，待统一命名并转移

检测到`气力值回复`弹窗后，若需消耗白金币则中止当前任务；否则点击`确认`，弹窗自然消失

### ⏳ `"气力值回复" ` ➡️ `...` ➡️ `"退出气力回复页面"` ➡️ `["行动A","行动B", ...]`

> ⚠️ 不建议配合`"interrupt"`字段使用的`气力值回复`弹窗调用方法。

如果想要使用这个模块，需要调用后自行在`"退出气力回复页面"`的`"next"`值列表中添加`"你原本想执行的行动"`。

暂定保留兼容性。

## 4. 关卡内行动（走格子）类操作（⏳ 或仅提供推荐参数？）

（检讨中）走格子行动用例（此处根据"next"中的顺序，会优先走 `黄格子` > `绿格子`）：

```json
"XX关卡走格子": {
    "next": ["XX关卡-走黄格子", "XX关卡-走绿格子", "识别出口（OCR）"],
    "interrupt": ["XX关卡-处理有的没的/对话（如鸢记）"]
},
"XX关卡-走黄格子":{
    "recognition": "ColorMatch",
    "roi": [98, 527, 519, 43],
    "method": 4,
    "upper": [218, 179, 112],
    "lower": [142, 103, 36],
    "count": 900,
    "order_by": "Score",
    "connected": true,
    "action": "Click",
    "post_wait_freezes": 1000,
    "next":["XX关卡走格子"]
},
"XX关卡-走绿格子":{ },
```

### ❓ `识别黄格子"`

（检讨中）目前仅推荐参数（经`突发情况（刷漆园蝶）`不同天气背景验证可用）

```json
    "recognition": "ColorMatch",
    "roi": [98, 527, 519, 43],
    "method": 4,
    "upper": [218, 179, 112],
    "lower": [142, 103, 36],
    "count": 900,
    "order_by": "Score",
    "connected": true,
```

### ❓ `识别绿格子`

（检讨中）目前仅推荐参数（经`6-24`验证可用）

```json
    "recognition": "ColorMatch",
    "roi": [70, 518, 613, 200],
    "method": 4,
    "upper" : [97, 92, 82],
    "lower": [48, 44, 39],
    "count": 10000,
    "order_by": "Score",
    "connected": true,
```

### ❓ `识别蓝格子`

（检讨中）目前仅推荐参数（经`他的传闻`中不同天气背景验证可用）

```json
    "recognition": "ColorMatch",
    "roi": [98, 527, 519, 43],
    "method": 4,
    "upper": [175, 201, 147],
    "lower": [142, 172, 119],
    "count": 900,
    "order_by": "Score",
    "connected": true,
```

### ❓ `"识别前进"`等 OCR（文字识别）类

目前仅推荐参数

```json
	"roi": [98, 527, 519, 43]
```
